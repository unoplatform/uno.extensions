<Page x:Class="TestHarness.Ext.Navigation.ForResult.ForResultSecondPage"
	  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
	  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
	  xmlns:uen="using:Uno.Extensions.Navigation.UI"
	  xmlns:utu="using:Uno.Toolkit.UI"
	  uen:Region.Attached="True"
	  Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">

	<Grid>
		<Grid.RowDefinitions>
			<RowDefinition Height="Auto" />
			<RowDefinition Height="*" />
		</Grid.RowDefinitions>

		<!-- NavigationBar with back button - this is key for the test -->
		<utu:NavigationBar Grid.Row="0"
						   Content="Second Page"
						   AutomationProperties.AutomationId="ForResultSecondPageNavigationBar"
						   Style="{StaticResource MaterialNavigationBarStyle}" />

		<StackPanel Grid.Row="1" 
					Spacing="10" 
					Padding="20">
			<TextBlock Text="Second Page - Loading..." 
					   Style="{StaticResource TitleTextBlockStyle}" />
			<TextBlock Text="This page simulates heavy ViewModel initialization. Quickly press the back button in the NavigationBar above to test the race condition fix."
					   TextWrapping="Wrap"
					   Margin="0,0,0,10" />
			
			<TextBlock x:Name="InitStatusText"
					   AutomationProperties.AutomationId="ForResultSecondPageInitStatus"
					   Text="Initializing..."
					   TextWrapping="Wrap"
					   Margin="0,20,0,0" />

			<Button Content="Return with Result"
					AutomationProperties.AutomationId="ForResultSecondPageReturnButton"
					Click="ReturnButton_Click"
					HorizontalAlignment="Stretch"
					Margin="0,20,0,0" />
		</StackPanel>
	</Grid>
</Page>
