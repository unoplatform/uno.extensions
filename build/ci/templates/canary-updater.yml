steps:
  - template: canary-update-template.yml
    parameters:
      SolutionToUpdate: 'Uno.Extensions.sln'

  - template: canary-update-template.yml
    parameters:
      SolutionToUpdate: 'samples/Playground/Playground.sln'

  - template: canary-update-template.yml
    parameters:
      SolutionToUpdate: 'samples/MauiEmbedding/MauiEmbedding.sln'

  - template: canary-update-template.yml
    parameters:
      SolutionToUpdate: 'testing/TestHarness/TestHarness.sln'

  - pwsh: |
      gci -r -include "info.plist" |
      foreach-object {
          $a = $_.fullname; ( get-content $a ) |
          foreach-object { $_ -replace "uno.platform.extensions.demo","uno.platform.extensions.demo-canary" } |
          set-content $a }
    displayName: 'Adjust info.plist bundle name'
    condition: startsWith(variables['Build.SourceBranch'], 'refs/heads/canaries')

  - pwsh: |
      gci -r -include AndroidManifest.xml,android-uitest-run.sh |
      foreach-object {
          $a = $_.fullname; ( get-content $a ) |
          foreach-object { $_ -replace "uno.platform.extensions.demo","uno.platform.extensions.demo.canary" } |
          set-content $a }
    displayName: 'Adjust AndroidManifest bundle name'
    condition: startsWith(variables['Build.SourceBranch'], 'refs/heads/canaries')
